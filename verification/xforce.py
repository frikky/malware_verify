import os
import sys
import json
import base64
import requests
import config as cfg

requests.packages.urllib3.disable_warnings()

class xforce(object):
	def __init__(self, cur_hash):
		token_data = "%s:%s" % (cfg.xforcetoken, cfg.xforcepassword)
		header_token = base64.b64encode(token_data)

		self.cur_hash = cur_hash
		self.header = {
			"Accept": "application/json", 
			"Authorization": "Basic %s" % header_token
		}

	def send_hash(self):
		target = "https://api.xforce.ibmcloud.com/malware/%s" % self.cur_hash
		data = requests.get(target, headers=self.header, verify=False)

		if data.status_code == 200:
			return data.json()
		
		return False
