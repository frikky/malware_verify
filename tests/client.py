import socket
import sys

target = "127.0.0.1"
port = int(sys.argv[1])

client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client.connect((target, port))

#Url and Hash test
hash="b1b7d87a62531d476cc2991bcb277984df4f6d2399796fe9a5830ee2f810cdca"
url="http://r6---sn-u2oxu-bqoe.gvt1.com/edgedl/release2/AP1DfGR95UU9/crl-set-delta-3885-5216029831134941676.crx.data?cms_redirect=yes&expire=1501596970&ip=188.252.105.10&ipbits=0&mm=28&mn=sn-u2oxu-bqoe&ms=nvh&mt=1501582454&mv=m&pl=17&shardbypass=yes&sparams=expire,ip,ipbits,mm,mn,ms,mv,pl,shardbypass&signature=3B7B701ADE64618D550A223609132B61CB515A85.83B8816796724D8C22E4824435EE96A5BB6085A0&key=cms1"

# Invalid
#hash= "68C23363AFCDFCCD8C16483E9C653F2A82C915810E956AB0BACF2BCB721DBBA6"

# Valid
#hash = "545C38B0922DE19734FBFFDE62792C37C2AEF6A3216CFA472449173165220F7D"


client.send("url: %s\nhash: %s" % (url, hash))

print client.recv(4096)
